%----------------------------------------
%---------------BEFORE-------------------
%----------------------------------------
%忽略Warning
\RequirePackage{silence}%忽略Warning的宏包，使用\WarningFilter时如果不放在cls内（如调试过程），那么就该包和\WarningFilter一起放在\doucumentclass之前
\WarningFilter{l3regex}{This package is obsolet}%忽略mhchem的固有错误，因为mhchem自带l3regex包而该包已老，需用expl3替代，所以有一个harmless的warning，这两个命令一定要加在class之前
\WarningFilter{biblatex}{Patching footnotes failed}%忽略BibTex的固有Warning.可放于后面
%----------------------------------------
%--------------基础宏包------------------
%----------------------------------------
%\RequirePackage{CJKutf8}%导入CJKutf8包，并且激活中文、日文、韩文的uft8编码
\RequirePackage{xeCJK}% CJKutf8包比较老旧，不兼容silence包，情况许可的话一般建议用 xeCJK 宏包集，或是 ctex 宏包集，然后用 xelatex 编译。恰巧xeCJK和silence 不会冲突，建议就用这个方法了。（也可使用ctex包，ctex包可兼容与LuaLatex；但也不支持pdfLatex，会提示“CTeX fontset `fandol' is unavailable in current mode.”）
%\RequirePackage{utopia} %font utopia imported
%\RequirePackage{pifont,manfnt}%特殊字符
%\RequirePackage{eulervm}%数学字体Euler virtual math fonts
\RequirePackage[utf8]{inputenc}%识别特殊字体的输入
\RequirePackage{beamerfoils}%控制Logo的出现和消失
\RequirePackage{booktabs}%允许表格中使用不同粗细的横线来划分行。
\RequirePackage[T1]{fontenc}%使用T1字体
\RequirePackage{xspace}%define macros that will insert a space dynamically 
\RequirePackage{rotating}%可以将文本、表格、图形旋转
\RequirePackage{multirow}%表格中某一单元横跨两行以上
\RequirePackage{graphicx}%图像
\RequirePackage{subfig}%子图
\usepackage{float} % Control the location of the figure
\RequirePackage{amsmath,amssymb,latexsym,amsfonts,amscd}%数学符号
\RequirePackage{fontawesome}%提供可缩放的矢量图标，如首页中的邮件
\RequirePackage{listings}%排版 C, C++, Pascal等源代码，提供语法加亮显示的功能
\RequirePackage{pgf}%pgf
\RequirePackage{multicol}%分栏/多列
\RequirePackage{expl3}%化学式相关的子包
\RequirePackage[version=4]{mhchem}%化学式相关
\RequirePackage{chemfig}%画化学分子
\usepackage{hyperref} %hyper link of reference
\usepackage{newtxtext,newtxmath}%用于替代旧的times 包，原包存在很多问题的，不建议使用。推荐 mathptmx, tgtermes 或是 newtxmath,newtxtext。
\usepackage{xcolor} % 用于替代旧的color包。
\usepackage{textcomp}%defines the macro \textquotesingle
%---------------------------------------------------------------
%----------------------------设置-------------------------------
%---------------------------------------------------------------
%------页面、段落设置 START------
\usepackage{geometry} %Page Size Usepackage
\geometry{a4paper,left=3cm,right=2.5cm,top=1.2cm,bottom=1.2cm} %Page Size and Margin
\hyphenpenalty=5000 % Deal with the overfull
\tolerance=1000 % Deal with the overfull
\usepackage{indentfirst}%首行缩进宏包
\setlength{\parindent}{2em}%首行缩进2字符!!!不能放的太靠前！！！
\renewcommand{\baselinestretch}{1.5}%1.5倍行距
%------页面、段落设置 END------

%------标题 START------
\usepackage[bf]{caption} % Bold fonts for caption
%样式设置
\captionsetup[figure]{labelfont={bf,small},textfont={it,small},name=Fig.,justification=centering}%设置figure的Caption格式
\captionsetup[table]{labelfont={bf,small},textfont={it,small},justification=centering}%设置table的Caption格式
\captionsetup[subfloat]{labelfont={bf,small},textfont={it,small},justification=centering}%设置subfloat的Caption格式
%位置设置
\setlength{\abovecaptionskip}{0pt} % Set the length between the caption and table
\setlength{\belowcaptionskip}{5pt} % Set the length between the caption and figure

\setlength\parindent{0pt} % Removes all indentation from paragraphs
%------标题 END------

%------enumerate设置 START------
\usepackage{enumerate}%设置enumerate格式
\renewcommand{\labelenumi}{(\theenumi)} % Make numbering in the enumerate environment by number rather than letter
%\renewcommand{\labelenumi}{\alph{enumi}.} % Make numbering in the enumerate environment by letter rather than number
%------enumerate设置 END------

%------单位相关 START------
\RequirePackage{siunitx}%数学单位
\sisetup{separate-uncertainty,multi-part-units = single,range-units = single} % Set for SI units
%------单位相关 END------

%------其他设置 START------
\DeclareTextFontCommand{\emph}{\color{red}}%更改强调的格式
\graphicspath{{../20180830/pic/}}%添加图片路径
\DeclareUnicodeCharacter{2212}{-}%Unicode U+2212 is MINUS SIGN, which is not set up by default with inputenc.Just add.
%参考文献 ARTICLE
\usepackage[super,square,sort,comma]{natbib} % Bibliography style 
%------其他设置 END------



%---------------------------------------------------------------
%------------------------BEAMER 专用部分------------------------
%---------------------------------------------------------------
%------主题 START------
\usetheme[compress]{Ilmenau}%模板主题
\usecolortheme{beaver}%颜色主题
\usefonttheme{serif}%字体主题
\useoutertheme{miniframes}
%------主题 START------

%------标题 BEAMER START------
\setbeamertemplate{caption}[numbered]
\setbeamertemplate{footline}[frame number]
\setbeamerfont{title}{family=\it}
\setbeamerfont{frametitle}{family=\it}
\setbeamercolor{button}{bg=DodgerBlue3,fg=white}%设置button的颜色
\hypersetup{colorlinks,linkcolor=,urlcolor=DodgerBlue3}%打开并设置超链接文本颜色
\hypersetup{pdfpagemode=FullScreen}% 设置用acrobat打开就会全屏显示
%------标题 BEAMER END------

%------参考文献 BEAMER START------
\RequirePackage[backend=biber,style=science]{biblatex}%BibTex参考文献宏包
%\addbibresource{../references.bib}%添加参考文献库
%\setbeamerfont{footnote}{size=\tiny}%调整footnote的格式
\setbeamercolor{bibliography entry author}{fg=purple4}%调整footnote参考文献的颜色
\setbeamercolor{footnote mark}{fg=purple4}%调整footnote的角标的颜色
%------参考文献 BEAMER END------

%------去掉参考文献中的一些field START------
\renewbibmacro{in:}{}
\AtEveryCitekey{
\clearfield{title}\clearfield{month}\clearfield{volume}\clearfield{number}\clearfield{pages}\clearfield{issn}\clearfield{pages}\clearfield{url}\clearfield{doi}
}
%------去掉参考文献中的一些field END------

%------BEAMER 导航栏 颜色 START------
\usepackage{ragged2e}
%\definecolor{gray2}{RGB}{242,242,242}%定义颜色Darkred
%\setbeamercolor{section in head/foot}{fg=white,bg=DarkRed}
%\setbeamercolor{subsection in head/foot}{fg=DarkRed,bg=gray2}
%\setbeamercolor{frametitle}{fg=DarkRed,bg=gray2}
%------BEAMER 导航栏 颜色 END------

%------调整导航栏高度 START------
%Add Section to Nav
%
\makeatletter
\setbeamertemplate{headline}{%
\begin{beamercolorbox}[wd=\paperwidth,ht=7.5ex]{section in head/foot}
    \insertnavigation{\paperwidth}
\end{beamercolorbox}
}
\makeatother
%Add Subsection to Nav
%
\makeatletter
%\begin{beamercolorbox}[wd=\paperwidth,ht=3ex]{subsection in head/foot}
%\quad\ \insertsubsection
%\end{beamercolorbox}
\makeatother
%------调整导航栏高度 END------

%------BEAMER Add Frametitle START------
\makeatletter
\setbeamertemplate{frametitle}{%
\vskip-1.1pt % to shift the frametitle
\begin{beamercolorbox}[wd=\paperwidth,sep=1.8pt]{frametitle}
\ \insertframetitle
\end{beamercolorbox} 
}
\makeatother
%------BEAMER Add Frametitle END------


%------BEAMER Add Frametitle START------
\makeatletter
\setbeamertemplate{section in head/foot}{\parbox[c][13.3ex][t]{\dimexpr(\textwidth-1.3cm)/\beamer@sectionmax\relax}{\RaggedRight\fontsize{4}{4}\selectfont\insertsectionhead}}
\makeatother
%------BEAMER Add Frametitle END------

%------Others ABout BEAMER START------
%\section[Title in Nav and Toc]{Title in Document}%If your titles are too long, you could consider using the optional argument of \section instead
%------Others ABout BEAMER END------



